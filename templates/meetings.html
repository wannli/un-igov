{% extends "base.html" %}
{% set page_title = "Meetings" %}
{% block content %}
<div class="bg-white border-b border-slate-200">
  <div class="mx-auto w-full max-w-6xl px-6 py-4">
    <nav class="flex items-center gap-2 text-sm text-slate-500">
      <a href="{{ site.base_url }}index.html" class="hover:text-slate-700">igov</a>
      <span class="text-slate-300">/</span>
      <span class="font-medium text-slate-700">GA</span>
      <span class="text-slate-300">/</span>
      <a href="{{ site.base_url }}ga/plenary/{{ session }}/meetings/index.html" class="font-medium text-slate-700 hover:text-slate-900">Plenary</a>
      <span class="text-slate-300">/</span>
      <span class="font-medium text-slate-700">{{ session }}</span>
      <span class="text-slate-300">/</span>
      <span class="font-medium text-slate-900">Meetings</span>
    </nav>
  </div>
</div>

<section class="bg-slate-50 border-b border-slate-200">
  <div class="mx-auto w-full max-w-6xl px-6 py-12">
    <h1 class="font-serif text-3xl text-slate-900">Meetings</h1>
  </div>
</section>

<section class="mx-auto w-full max-w-6xl px-6 py-8">
  <div class="mb-8 flex items-center gap-4">
    <select class="rounded-lg border border-slate-300 bg-white px-4 py-2 text-sm text-slate-700 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500">
      <option>All</option>
      <option>Formal meetings</option>
      <option>Informal meetings</option>
      <option>Informal consultations</option>
    </select>
  </div>

  <div class="space-y-4">
    {% set upcoming_meetings = [] %}
    {% set past_meetings = [] %}

    {% for meeting in meetings %}
      {% set meeting_date = meeting.MT_dateTimeScheduleStart[:10] %}
      {% if meeting_date >= current_date %}
        {% set upcoming_meetings = (upcoming_meetings.append(meeting), upcoming_meetings) %}
      {% else %}
        {% set past_meetings = (past_meetings.append(meeting), past_meetings) %}
      {% endif %}
    {% endfor %}

    {% if upcoming_meetings %}
      <h2 class="mb-4 text-lg font-semibold text-slate-900">Upcoming meetings</h2>
      <div class="space-y-4">
        {% for meeting in upcoming_meetings %}
          <article class="rounded-lg border border-slate-200 bg-white p-4 shadow-sm transition-shadow hover:shadow-md">
            <div class="flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between">
              <div class="flex-1">
                <h2 class="text-lg font-medium text-slate-900">{{ meeting.MT_name or "Meeting" }}</h2>
                <p class="mt-1 text-sm text-slate-500">
                  {% if meeting.MT_type %}{{ meeting.MT_type }}{% endif %}
                  {% if meeting.MT_session %}· {{ meeting.MT_session }}{% endif %}
                </p>
                {% if meeting.MT_commentary %}
                  <div class="mt-3 text-sm text-slate-600 prose prose-sm max-w-none">
                    {{ meeting.MT_commentary | safe }}
                  </div>
                {% endif %}
              </div>
              <div class="flex flex-col items-end gap-1 text-sm text-slate-600 whitespace-nowrap">
                <span class="font-medium">{{ meeting.MT_dateTimeScheduleStart | datetime_format("%A, %d %B %Y") }}</span>
                <span>{{ meeting.MT_dateTimeScheduleStart[11:16] }} - {{ meeting.MT_dateTimeScheduleEnd[11:16] }}</span>
                {% if meeting.MT_room %}
                  <span class="text-slate-500">{{ meeting.MT_room }}</span>
                {% endif %}
              </div>
            </div>
            {% if meeting.MT_segment %}
              <div class="mt-4 border-t border-slate-100 pt-4">
                <ul class="space-y-1 text-sm text-slate-700">
                  {% for segment in meeting.MT_segment[:5] %}
                    <li class="flex items-start gap-2">
                      <span class="mt-1.5 h-1.5 w-1.5 shrink-0 rounded-full bg-blue-500"></span>
                      <span>{{ segment.MTS_segmentTitle }}</span>
                    </li>
                  {% endfor %}
                  {% if meeting.MT_segment | length > 5 %}
                    <li class="text-sm text-slate-500">+ {{ meeting.MT_segment | length - 5 }} more items</li>
                  {% endif %}
                </ul>
              </div>
            {% endif %}
          </article>
        {% endfor %}
      </div>
    {% endif %}

    {% if past_meetings %}
      <h2 class="mt-10 mb-4 text-lg font-semibold text-slate-900">Past meetings</h2>
      <div class="space-y-3">
        {% for meeting in past_meetings %}
          <article class="flex flex-col gap-2 rounded-lg border border-slate-200 bg-white p-4 sm:flex-row sm:items-start sm:justify-between">
            <div>
              <h3 class="font-medium text-slate-900">{{ meeting.MT_name or "Meeting" }}</h3>
              <p class="mt-1 text-sm text-slate-500">
                {% if meeting.MT_type %}{{ meeting.MT_type }}{% endif %}
                {% if meeting.MT_session %}· {{ meeting.MT_session }}{% endif %}
              </p>
            </div>
            <div class="flex flex-col items-end gap-1 text-sm text-slate-600 whitespace-nowrap">
              <span>{{ meeting.MT_dateTimeScheduleStart | datetime_format("%A, %d %B %Y") }}</span>
              <span>{{ meeting.MT_dateTimeScheduleStart[11:16] }} - {{ meeting.MT_dateTimeScheduleEnd[11:16] }}</span>
            </div>
          </article>
        {% endfor %}
      </div>
    {% endif %}

    {% if not meetings %}
      <div class="rounded-lg border border-slate-200 bg-white p-12 text-center">
        <p class="text-slate-500">No meetings data available yet.</p>
      </div>
    {% endif %}
  </div>
</section>
{% endblock %}
